# ğŸ“§ Complete Email System Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SHOPPING CART APPLICATION                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ Customer adds items
                                â”‚ and checks out
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Cart Panel          â”‚
                    â”‚   (cart-panel.tsx)    â”‚
                    â”‚                       â”‚
                    â”‚ â€¢ User enters email   â”‚
                    â”‚ â€¢ Validates email     â”‚
                    â”‚ â€¢ Sends to API        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ POST /api/checkout
                                â”‚ { email, cart, amounts }
                                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     Checkout API (route.tsx)                  â”‚
        â”‚                                               â”‚
        â”‚  1. Validate email & cart                    â”‚
        â”‚  2. Generate Order ID (ORD-XXXXX)           â”‚
        â”‚  3. Create HTML receipt                      â”‚
        â”‚  4. Check Resend API key                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                       â”‚
                    â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  BUYER EMAIL         â”‚ â”‚  ADMIN EMAIL         â”‚
        â”‚  PROCESS            â”‚ â”‚  PROCESS            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                       â”‚
                    â”‚                       â”‚
                    â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Check if can send:  â”‚ â”‚ Check if can send:  â”‚
        â”‚ â€¢ Has valid API key â”‚ â”‚ â€¢ Has valid API key â”‚
        â”‚ â€¢ Using resend.dev  â”‚ â”‚ â€¢ Using resend.dev  â”‚
        â”‚   OR                â”‚ â”‚   OR                â”‚
        â”‚ â€¢ ALLOW_ALL_EMAILS  â”‚ â”‚ â€¢ ALLOW_ALL_EMAILS  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                       â”‚
                    â”‚ âœ… YES                â”‚ âœ… YES
                    â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Resend API        â”‚ â”‚   Resend API        â”‚
        â”‚   resend.send()     â”‚ â”‚   resend.send()     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                       â”‚
                    â”‚                       â”‚
                    â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ğŸ“§ Email Sent to:  â”‚ â”‚  ğŸ“§ Email Sent to:  â”‚
        â”‚                     â”‚ â”‚                     â”‚
        â”‚  customer@gmail.com â”‚ â”‚  uvicornshoppie@    â”‚
        â”‚                     â”‚ â”‚  gmail.com          â”‚
        â”‚  SUBJECT:           â”‚ â”‚                     â”‚
        â”‚  Uvicorn Order      â”‚ â”‚  SUBJECT:           â”‚
        â”‚  ORD-XXXXX          â”‚ â”‚  [ADMIN COPY]       â”‚
        â”‚                     â”‚ â”‚  Uvicorn Order XXX  â”‚
        â”‚  CONTENT:           â”‚ â”‚                     â”‚
        â”‚  â€¢ Thank you        â”‚ â”‚  CONTENT:           â”‚
        â”‚  â€¢ Order items      â”‚ â”‚  â€¢ ğŸ”” Admin Banner  â”‚
        â”‚  â€¢ Prices           â”‚ â”‚  â€¢ Customer email   â”‚
        â”‚  â€¢ Totals           â”‚ â”‚  â€¢ Order items      â”‚
        â”‚                     â”‚ â”‚  â€¢ Prices & totals  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                       â”‚
                    â”‚                       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Return Response     â”‚
                    â”‚   to Frontend         â”‚
                    â”‚                       â”‚
                    â”‚   {                   â”‚
                    â”‚     orderId,          â”‚
                    â”‚     emailed: true,    â”‚
                    â”‚     emailedOwner: trueâ”‚
                    â”‚   }                   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Show Success        â”‚
                    â”‚   Message to User     â”‚
                    â”‚                       â”‚
                    â”‚   "Order #ORD-XXX     â”‚
                    â”‚    confirmed.         â”‚
                    â”‚    Receipt emailed."  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Email Routing Logic

### Buyer Email Path

```
Buyer enters: customer@example.com
                    â†“
        [Normalize & Validate Email]
                    â†“
        recipientEmail = "customer@example.com"
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Can send buyer email?        â”‚
        â”‚                              â”‚
        â”‚ hasValidKey = true?          â”‚
        â”‚   AND                        â”‚
        â”‚ (IS_RESEND_DEV_SENDER        â”‚
        â”‚  OR ALLOW_ALL_EMAILS)?       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                âœ… YES
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Send via Resend API          â”‚
        â”‚                              â”‚
        â”‚ FROM: Uvicorn Orders         â”‚
        â”‚       <onboarding@resend.dev>â”‚
        â”‚ TO: customer@example.com     â”‚
        â”‚ SUBJECT: Uvicorn Order XXX   â”‚
        â”‚ REPLY-TO: customer@example.comâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        ğŸ“§ Email delivered to buyer
```

### Admin Email Path

```
Admin email: uvicornshoppie@gmail.com
                    â†“
        [Build Admin Recipients List]
                    â†“
        adminRecipients = [
          "uvicornshoppie@gmail.com"
        ]
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Can send admin email?        â”‚
        â”‚                              â”‚
        â”‚ hasValidKey = true?          â”‚
        â”‚   AND                        â”‚
        â”‚ adminRecipients.length > 0?  â”‚
        â”‚   AND                        â”‚
        â”‚ (IS_RESEND_DEV_SENDER        â”‚
        â”‚  OR ALLOW_ALL_EMAILS)?       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                âœ… YES
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Send via Resend API          â”‚
        â”‚                              â”‚
        â”‚ FROM: Uvicorn Orders         â”‚
        â”‚       <onboarding@resend.dev>â”‚
        â”‚ TO: uvicornshoppie@gmail.com â”‚
        â”‚ SUBJECT: [ADMIN COPY]        â”‚
        â”‚          Uvicorn Order XXX   â”‚
        â”‚                              â”‚
        â”‚ HTML: Admin banner +         â”‚
        â”‚       Order details          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        ğŸ“§ Email delivered to admin
```

---

## Configuration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Environment Variables           â”‚
â”‚     (.env.local)                    â”‚
â”‚                                     â”‚
â”‚  RESEND_API_KEY=re_xxxxx           â”‚
â”‚  FROM_SENDER=optional              â”‚
â”‚  ALLOW_ALL_EMAILS=optional         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Constants Initialization        â”‚
â”‚                                     â”‚
â”‚  DEFAULT_FROM =                    â”‚
â”‚    "Uvicorn Orders                 â”‚
â”‚     <onboarding@resend.dev>"       â”‚
â”‚                                     â”‚
â”‚  IS_RESEND_DEV_SENDER = true       â”‚
â”‚    (using resend.dev domain)       â”‚
â”‚                                     â”‚
â”‚  DEFAULT_OWNER =                   â”‚
â”‚    "uvicornshoppie@gmail.com"      â”‚
â”‚                                     â”‚
â”‚  ADMIN_EMAIL =                     â”‚
â”‚    "uvicornshoppie@gmail.com"      â”‚
â”‚                                     â”‚
â”‚  HAS_VALID_RESEND_KEY =            â”‚
â”‚    check if key starts with "re_"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
        Email sending enabled! âœ…
```

---

## Data Flow

### Request Flow
```
Client (Browser)
    â†“
    POST /api/checkout
    {
      email: "customer@gmail.com",
      cart: {
        items: [
          {
            product: { id, name, price },
            quantity: 2
          }
        ]
      },
      amounts: {
        subtotal: 5498,
        tax: 989.64,
        total: 6487.64
      }
    }
    â†“
Server (Next.js API Route)
    â†“
1. Validate cart & email
2. Generate Order ID
3. Create HTML receipt
4. Send buyer email
5. Send admin email
    â†“
Response
    {
      orderId: "ORD-MGLV75CV",
      emailed: true,
      emailSimulated: false,
      recipients: ["customer@gmail.com"],
      emailedOwner: true,
      ownerSimulated: false,
      adminRecipients: ["uvicornshoppie@gmail.com"]
    }
    â†“
Client (Browser)
    Shows success message
```

---

## Email Template Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BUYER EMAIL                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  Order Confirmation - ORD-XXXXX             â”‚
â”‚                                             â”‚
â”‚  Thank you for your purchase from Uvicorn.  â”‚
â”‚                                             â”‚
â”‚  Receipt recipient: customer@email.com      â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ITEMS TABLE                        â”‚   â”‚
â”‚  â”‚  â€¢ Item name                        â”‚   â”‚
â”‚  â”‚  â€¢ Quantity                         â”‚   â”‚
â”‚  â”‚  â€¢ Price                            â”‚   â”‚
â”‚  â”‚  â€¢ Line total                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  Subtotal: â‚¹X,XXX.XX                        â”‚
â”‚  GST (18%): â‚¹XXX.XX                         â”‚
â”‚  Total: â‚¹X,XXX.XX                           â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ADMIN EMAIL                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”” Admin Notification                 â”‚ â”‚
â”‚  â”‚ This is an admin copy of the order    â”‚ â”‚
â”‚  â”‚ receipt.                              â”‚ â”‚
â”‚  â”‚ Customer email: customer@email.com    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  Order Confirmation - ORD-XXXXX             â”‚
â”‚                                             â”‚
â”‚  Thank you for your purchase from Uvicorn.  â”‚
â”‚                                             â”‚
â”‚  Receipt recipient: customer@email.com      â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ITEMS TABLE                        â”‚   â”‚
â”‚  â”‚  (Same as buyer email)              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  Subtotal, GST, Total                       â”‚
â”‚  (Same as buyer email)                      â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Flow

```
                [POST /api/checkout]
                        â”‚
                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Validate Request      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
   âŒ Empty cart   âŒ Invalid     âœ… Valid
                    email
        â”‚               â”‚               â”‚
        â–¼               â–¼               â–¼
   Return 400    Return 400      Continue
   {error}       {error}              â”‚
                                      â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Try Send Buyer Email  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                           â”‚
                        â–¼                           â–¼
                    âœ… Success                  âŒ Error
                        â”‚                           â”‚
                emailed: true                emailed: false
                        â”‚                   emailSimulated: true
                        â”‚                        note: "..."
                        â”‚                           â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Try Send Admin Email  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                           â”‚
                        â–¼                           â–¼
                    âœ… Success                  âŒ Error
                        â”‚                           â”‚
                emailedOwner: true        emailedOwner: false
                        â”‚                  ownerSimulated: true
                        â”‚                    ownerNote: "..."
                        â”‚                           â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Return Success (200)  â”‚
                        â”‚ With status details   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

### Key Components
1. **Cart Panel** - Collects user email and cart data
2. **Checkout API** - Processes order and sends emails
3. **Resend API** - Email delivery service
4. **Email Templates** - HTML formatted receipts

### Email Recipients
- **Buyer**: Gets order confirmation
- **Admin**: `uvicornshoppie@gmail.com` gets copy of all orders

### Email Sender
- Default: `Uvicorn Orders <onboarding@resend.dev>`
- Can be customized with verified domain

### Success Criteria
- âœ… Buyer receives email at their address
- âœ… Admin receives copy at uvicornshoppie@gmail.com
- âœ… Both emails contain complete order details
- âœ… Admin email has notification banner
- âœ… No errors in API response
